<div align="center">
  <a href="https://muxinzhuo.github.io/investment-dashboard/">
    <img src="https://img.shields.io/badge/🚀_点击这里_立刻启动工具-Start-blue?style=for-the-badge&logo=rocket&logoColor=white" height="50">
  </a>
</div>

<br>
<img width="2262" height="3653" alt="image" src="https://github.com/user-attachments/assets/c61e32bc-93aa-4fd8-a6c1-71da63a64bf9" />

# 🛡️ 资产配置引擎 (Asset Allocation Engine)

> **V18.5 修复版 | 极简主义投资者的纪律执行工具**

这是一个基于 Web 的单文件（Single-file）资产再平衡计算器。它是为了解决长期投资者在执行策略时面临的**计算繁琐**、**情绪干扰**和**过度交易**问题而设计的。

本工具完全运行在本地浏览器中（纯 HTML/JS），**不会上传任何资产数据到服务器**，确保你的隐私安全。

---

## 🧠 核心设计逻辑

本引擎不同于简单的“按比例卖出买入”计算器，它遵循以下核心投资哲学：

### 1. 流入式再平衡 (Inflow Rebalancing)
**核心思想**：尽量不卖出上涨的优质资产，而是通过新投入的资金（New Cash）去填补那些占比不足的资产。
* **算法**：采用“瀑布流（Waterfall）”算法。系统会计算所有资产的缺口，优先将资金分配给缺口最大（相对目标占比最少）的资产，直到资金耗尽。

### 2. 波动率带宽保护 (Sigma Bands)
**核心思想**：不同波动率的资产，应该拥有不同的“容错空间”。
* **机制**：我们不追求 100% 精确的配比。只要持仓在 `目标占比 ± (K * 波动率σ)` 的范围内，系统就会判定为**“安全”**，阻止任何微小的调仓操作。
* **效果**：避免了为了 0.5% 的偏差去频繁交易，节省手续费并减少税务摩擦。

### 3. LRS 趋势防御 (Low Risk System)
**核心思想**：当特定资产发生基本面恶化或技术面破位时，需要一套“熔断机制”。
* **隔离态 (Quarantine)**：当你手动标记某资产为“趋势破位”时，引擎会立刻停止买入该资产（即使它跌了很多）。资金会自动分流到其他健康资产或保留为现金。
* **高压阀**：只有当该问题资产暴涨超过极值（如目标仓位的 1.5 倍）时，才会建议卖出，否则保持静默。

---

## 🛠️ 功能特性

* **🔒 隐私优先**：无需后端，所有数据存储在本地 `localStorage`。
* **🌊 瀑布流买入**：自动计算最优买入路径，资金利用率最大化。
* **📉 智能卖出逻辑**：
    * **小资金保护**：如果是整股交易（非碎股），系统会计算交易磨损，避免为了再平衡而卖出 1 股导致的高成本。
    * **高压卖出**：只有突破安全带宽上限（触顶）时才会触发卖出信号。
* **💸 多币种支持**：支持 CNY/HKD/USD 混合计价，自动获取实时汇率。
* **☁️ 自动股价更新**：集成 Finnhub API，一键刷新持仓市值。
* **📊 数据快照**：支持导出/导入 JSON 配置，方便备份或在不同设备间迁移。

---

## 🚀 快速开始

### 1. 准备工作
本工具是一个独立的 `.html` 文件。
* **下载**：下载本项目中的 `index.html`。
* **运行**：直接用 Chrome / Edge / Safari 浏览器打开该文件即可。
* **获取 API Key（可选但推荐）**：
    为了自动更新股价，建议去 [Finnhub.io](https://finnhub.io/) 注册一个免费账号，复制你的 API Key。

### 2. 配置资产
在表格中录入你的持仓信息：
* **代码 (Symbol)**：美股代码（如 `AAPL`, `QLD`, `IBIT`）。
* **LRS**：是否启用趋势保护（勾选后可手动标记趋势状态）。
* **碎股支持**：如果你使用的券商（如嘉信理财、富途）支持按金额买入碎股，请勾选。
* **目标 %**：你期望的仓位占比（总和需为 100%）。
* **波动率 σ**：给资产的波动率打分。建议值：
    * `VOO/SPY`: 0.15
    * `QQQ`: 0.20
    * `QLD/SSO` (2倍杠杆): 0.40
    * `TQQQ` (3倍杠杆): 0.60
    * `IBIT/COIN` (加密类): 0.70
* **持仓股数**：你当前持有的股数。

### 3. 每周/每月定投操作 (SOP)
1.  **更新股价**：点击 `☁️ 更新股价`（需填 API Token），或手动修正价格。
2.  **输入入金**：在“本周新增入金”处填入你准备投入的金额（支持 CNY，会自动换算）。
3.  **生成指令**：点击 `🔒 执行纪律计算`。
4.  **执行操作**：
    * 查看下方的 **“🚀 本周操作指令”**。
    * 严格按照指令在券商软件中下单。
    * **注意**：如果系统提示“保留避险”，请不要强行把钱花光。

---

## ❓ 常见问题 (Q&A)

**Q: 为什么我的资产占比低于目标，系统却不让我买入？**
A: 可能是因为该资产处于“安全带宽”内（偏差不够大），或者你没有勾选“碎股支持”，而剩余资金不足以买入 1 整股。

**Q: LRS “趋势破位”是什么意思？**
A: 这是留给你的人工判断接口。如果你判断某个标的进入了技术性熊市或基本面崩盘，点击表格中的“🟢 趋势向上”按钮将其切换为“📉 趋势破位”。此时系统会进入**防御模式**，拒绝向该标的投入任何新资金，直到你手动恢复它。

**Q: 如何备份我的数据？**
A: 点击底部的 `📤 导出配置`，你会得到一个 JSON 文件。在另一台电脑上点击 `📥 导入快照` 粘贴内容即可恢复。

---

## ⚠️ 免责声明

本工具仅作为资产配置的辅助计算器，**不构成任何投资建议**。
* 作者不对因使用本工具产生的任何投资损失负责。
* 代码逻辑公开透明，请在使用前自行验证计算结果。
* 股市有风险，入市需谨慎。

---

